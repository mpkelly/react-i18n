"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e,t=require("react"),r=(e=t)&&"object"==typeof e&&"default"in e?e.default:e;const n=(e,t)=>{const r=[];let n;const o=RegExp(e,"g");for(;null!==(n=o.exec(t));)r.push({offsets:[n.index,n.index+n[0].length],array:n});return r},o=(e,t)=>e.match.offsets[0]-t.match.offsets[0],s={pattern:/(\*\*|__)(.*?)\1/,onMatch:(e,t)=>r.createElement("strong",{key:t},e[2])},a={pattern:/(\*|_)(.*?)\1/,onMatch:(e,t)=>r.createElement("em",{key:t},e[2])},l={pattern:/~~(.*?)~~/,onMatch:(e,t)=>r.createElement("del",{key:t},e[1])},c={pattern:/`(.*?)`/,onMatch:(e,t)=>r.createElement("code",{key:t},e[1])},u={pattern:/\[([^\[]+)\]\(([^\)]+)\)/,onMatch:(e,t)=>r.createElement("a",{key:t,href:e[2]},e[1])},f=[s,a,c,l,u],i=t.createContext(void 0),p=()=>t.useContext(i),h=e=>{const{bundles:n,children:o,markdownRules:s,lang:a}=e,l=p();let c,u,f={},h=[];l&&(f=l.bundle,c=l.lang,u=l.resolveLanguageBundle,h=l.markdownRules);const d=(s||[]).filter(e=>!h.includes(e)).concat(h),[y,g]=t.useState(),b=a||c;if(!b)throw Error("No `lang` prop specified");t.useEffect(()=>{g(void 0)},[a]);const x=t.useCallback(e=>Promise.all([new Promise(t=>{f&&e===c?t(f):u?u(b).then(t):t({})}),new Promise(t=>{n&&n[e]?n[e]().then(m).then(t):t({})})]).then(e=>{let t={};return e.forEach(e=>{t=Object.assign(Object.assign({},t),e)}),t}),[b,c,f,n,u]);return t.useEffect(()=>{y||x(b).then(g)},[y,b,f,n,x]),y?r.createElement(i.Provider,{value:{resolveLanguageBundle:x,lang:b,bundle:y,markdownRules:d}},o):null};h.defaultProps={markdownRules:f};const m=e=>{const t={};for(let r in e)if(e.hasOwnProperty(r))if("object"==typeof e[r]&&null!==e[r]){const n=m(e[r]);for(let e in n)n.hasOwnProperty(e)&&(t[r+"."+e]=n[e])}else t[r]=e[r];return t};function d(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}exports.BoldRule=s,exports.DefaultMarkdownRules=f,exports.I18NProvider=h,exports.InlineCodeRule=c,exports.ItalicRule=a,exports.LinkRule=u,exports.StrikethroughRule=l,exports.findRegex=n,exports.formatCurrency=(e,t,r={style:"currency"},n)=>new Intl.NumberFormat(n,Object.assign(Object.assign({},r),{currency:t})).format(e),exports.formatDate=(e,t,r)=>new Intl.DateTimeFormat(r,t).format(e),exports.pluralize=(e,t,r,n)=>{const o=new Intl.PluralRules(n).select(e);switch(o){case"one":return`${e} ${t}`;case"other":return`${e} ${r}`}throw Error(`Unable to match ${o}.`)},exports.transform=(e,t)=>{if(!t.length)return[e];const r=[],s=[];let a=e;if(t.forEach(e=>{n(e.pattern,a).forEach(t=>{const r=Array.from({length:t.array[0].length}).map(()=>" ").join("");a=a.replace(t.array[0],r),s.push({match:t,rule:e})})}),a===e)return[e];a=e;let l=0;return s.sort(o).forEach((e,t)=>{const[n,o]=e.match.offsets,c=a.substring(l,n);if(c&&r.push(c),r.push(e.rule.onMatch(e.match.array,t)),l=o,t+1===s.length){const e=a.substring(l);e&&r.push(e)}}),r},exports.useI18N=p,exports.withI18N=function(e){return t.forwardRef((t,n)=>{const o=(e=>{let{i18n:t=""}=e,r=d(e,["i18n"]);if(!t)return e;const{bundle:n}=p();return(e=>"string"==typeof e?[{children:e}]:Array.isArray(e)?e:[e])(t).forEach(e=>{const{args:t=[]}=e,o=d(e,["args"]),s=Object.keys(o)[0],a=n[e[s]];a&&(r[s]="string"==typeof a?a:a(...t))}),r})(t);return r.createElement(e,Object.assign({},o,{ref:n}))})};
